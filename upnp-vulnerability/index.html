<!DOCTYPE HTML>
<html lang="en">

<head>


<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta property="og:image" content="https://btcinformation.org/img/icons/opengraph.png?1533691837" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Vulnerability in UPnP library used by Bitcoin Core</title>

<link rel="stylesheet" href="/css/font-awesome-4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/main.css?1533691837">
<!--[if lt IE 8]><link rel="stylesheet" href="/css/ie.css"><script type="text/javascript" src="/js/ie.js"></script><![endif]-->
<!--[if IE 8]><link rel="stylesheet" href="/css/ie8.css"><![endif]-->


<script type="text/javascript" src="/js/base.js"></script>
<script type="text/javascript" src="/js/main.js"></script>
<link rel="shortcut icon" href="/favicon.png">
<link rel="apple-touch-icon-precomposed" href="/img/icons/logo_ios.png"/>

</head>

<body>



<div id="detectmobile" class="detectmobile"></div>







<div class="head"><div>
  

<a class="logo" href="/en/"><img src="/img/icons/logotop.svg" alt="Bitcoin"></a>

  

<ul id="menusimple" class="menusimple menumain" onclick="mobileMenuHover(event);" ontouchstart="mobileMenuHover(event);">
  <li><a>Introduction</a>
    <ul>
      <li><a href="/en/bitcoin-for-individuals">Individuals</a></li>
      <li><a href="/en/bitcoin-for-businesses">Businesses</a></li>
      <li><a href="/en/bitcoin-for-developers">Developers</a></li>
      <li><a href="/en/getting-started">Getting started</a></li>
      <li><a href="/en/how-it-works">How it works</a></li>
      <li><a href="/en/you-need-to-know">You need to know</a></li>
    </ul>
  </li>
  <li><a>Resources</a>
    <ul>
      <li><a href="/en/resources">Resources</a>
      <li><a href="/en/exchanges">Exchanges</a></li>
      <li><a href="/en/community">Community</a></li>
      
      
      <li><a href="/en/developer-documentation">Documentation</a></li>
      
      <li><a href="/en/vocabulary">Vocabulary</a></li>
    </ul>
  </li>
  <li><a href="/en/innovation">Innovation</a></li>
  <li><a>Participate</a>
    <ul>
      <li><a href="/en/support-bitcoin">Support Bitcoin</a>
      <li><a href="/en/buy">Buy Bitcoin</a></li>
    </ul>
  </li>
  <li><a href="/en/faq">FAQ</a></li>
</ul>

  

<a id="menumobile" class="menumobile" onclick="mobileMenuShow(event);" ontouchstart="mobileMenuShow(event);"></a>

</div></div>

<div class="body">
  

<div class="breadcrumbs">
  
</div>

  

<div id="content" class="content">
  
<script>window.location.href='/en/alert/2015-10-12-upnp-vulnerability';</script>
<link rel="canonical" href="https://btcinformation.org/en/alert/2015-10-12-upnp-vulnerability"/>


<link rel="alternate" type="application/rss+xml" href="/en/rss/alerts.rss" title="Bitcoin network status and alerts">

<div class="subhead-links">
  <a href="/en/alerts">Network alerts history</a>
| <a type="application/rss+xml" href="/en/rss/alerts.rss"><img src="/img/icons/header_rss.svg" alt="rss" class="rssicon"> Subscribe to RSS feed</a>
| <a href="https://github.com/achow101/btcinformation.org/commits/master/_alerts/2015-10-12-upnp-vulnerability.md">Post history</a>
| <a href="https://github.com/achow101/btcinformation.org/issues/new?body=Source%20File%3A%20_alerts/2015-10-12-upnp-vulnerability.md%0A%0A">Report issue</a>
</div>

<div class="post">

  <header class="post-header">
    <h1 class="post-title alerttitle"><img src="/img/icons/warning.svg" alt="warning">Vulnerability in UPnP library used by Bitcoin Core<br><small>12 October 2015</small></h1>
  </header>

  <article class="post-content">
    <h2 id="summary">Summary</h2>

<p><img src="/img/alerts/disable_upnp.png?1533691837" alt="Disabling UPnP in the GUI" /></p>

<p>Either</p>

<ul>
  <li>turn off the checkbox in the GUI under Options → Network → Map port using UPNP (see above)</li>
  <li>add the line <code class="highlighter-rouge">upnp=0</code> to your <code class="highlighter-rouge">bitcoin.conf</code> file</li>
  <li>add <code class="highlighter-rouge">-upnp=0</code> to the command line options</li>
</ul>

<p>Also <a href="https://bitcoincore.org/en/download">upgrade</a> to a version of Bitcoin Core at least 0.10.3
or 0.11.1. These versions upgrade the
library to a non-vulnerable version, as well as disable UPnP by default to
prevent this problem in the future.</p>

<h2 id="details">Details</h2>

<p>Version before 1.9.20151008 of the miniupnpc library are vulnerable to a buffer
overflow in the XML parser during initial network discovery. The
vulnerable code triggers at startup of Bitcoin Core if UPnP is enabled.</p>

<p>Details of the vulnerability can be found here: <a href="http://talosintel.com/reports/TALOS-2015-0035/">http://talosintel.com/reports/TALOS-2015-0035/</a></p>

<p>It has been verified that the vulnerability can be used to crash the
application at startup by running a malicious UPnP server on the local
network.</p>

<p>To have more connectable nodes, the Bitcoin Core executables distributed by
the project include the miniupnpc library and have always had UPnP
functionality enabled by default, to forward the P2P port.</p>

<p>This applies to the distributed executables only, not those built from source or
from distribution provided packages. Self-built executables have UPnP disabled
by default, unless <code class="highlighter-rouge">--enable-upnp-default</code> was provided to the configure script.</p>

<p>Releases starting from 0.10.3 and 0.11.1, and the upcoming 0.12.0 will still ship
with (a patched version) of the library, but no longer enable the functionality by default.</p>

<h2 id="mitigation">Mitigation</h2>

<p>Bitcoin Core executables are compiled with Address Space Layout Randomization (ASLR),
Stack Smashing Protection (SSP), and non-executable stack and heap (DEP) enabled. This
makes it harder to use this vulnerability for remote code execution or private
key leaks. However, it is still advised to upgrade, or if not possible, disable
UPnP as soon as possible.</p>

<h2 id="manual-port-forwarding">Manual Port Forwarding</h2>

<p>With UPnP turned off, your node will still connect to 8 other peers on
the Bitcoin network to receive new blocks and transactions.  However, it
will not accept incomming connections from other peers unless you
manually enable port forwarding on your router.  If you wish to do
that—it isn’t required—please <a href="/en/full-node#network-configuration">follow these
instructions</a>.</p>

  </article>

</div>

</div>

  <div class="footer">
    



<div class="footermenu">
  <a href="/en/alerts" class="statusmenu">Network Status</a>
  <a href="/en/legal">Legal</a>
  
  <a href="/en/privacy">Privacy Policy</a>
  
  <a href="/en/press">Press</a>
  <a href="/en/about-us">About btcinformation.org</a>
  <a href="/en/blog">Blog</a>
</div>

    

<div class="footersponsor">
  <!--<div><span>A community website sponsored by</span> <a href="https://bitcoinfoundation.org/"><img src="/img/brand/bitcoinfoundation.png?1533691837" alt="Bitcoin Foundation"></a></div>-->
</div>

    

<div class="footerlicense">© Bitcoin Project 2009-2018 Released under the <a href="http://opensource.org/licenses/mit-license.php" target="_blank">MIT license</a></div>

  </div>
</div>



<script type="text/javascript">
  fallbackSVG();
  addAnchorLinks();
</script>






</body>

</html>
